# Test-mode compose override for auth stack.
# Applied automatically by deploy_single_stack.yaml when _test_mode is true.
# Extends SWAG healthcheck timing to accommodate Certbot DNS validation timeout
# on the isolated test VLAN. Restored certs from appdata let nginx serve once
# Certbot finishes.
services:
  swag:
    healthcheck:
      test: ["CMD-SHELL", "curl -fsk https://localhost:443 || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 300s
