# Rendered by deploy_stacks.yaml — do not edit manually
# Stack: auth | Host: {{ inventory_hostname }}

## Global
MEM_LIMIT={{ docker_mem_limit }}
RESTART={{ docker_restart }}
TZ={{ docker_tz }}
PUID={{ docker_puid }}
PGID={{ docker_pgid }}
UMASK={{ docker_umask }}
APPSDIR={{ docker_appsdir }}

## Authentik
AUTHENTIK_IMAGE={{ docker_authentik_image }}
AUTHENTIK_TAG={{ docker_authentik_tag }}
AUTHENTIK_SECRET_KEY={{ docker_authentik_secret_key }}
AUTHENTIK_POSTGRES_DB=authentik
AUTHENTIK_ERROR_REPORTING_ENABLED=true
AUTHENTIK_WORKER_CONCURRENCY=2
AUTHENTIK_WORKERS=2
AUTHENTIK_LISTEN__TRUSTED_PROXY_CIDRS={{ docker_trusted_proxy_cidrs }}
AUTHENTIK_EMAIL_FROM=sso@{{ docker_base_domain }}
AUTHENTIK_EMAIL_USE_TLS=true
AUTHENTIK_EMAIL_TIMEOUT=10

## Authentik — database connection (Postgres in databases stack on same host)
POSTGRES_HOST={{ vault_vm_tantiveiv_ip }}
POSTGRES_USER={{ docker_postgres_user }}
POSTGRES_PASSWORD={{ docker_postgres_password }}

## Authentik — email
EMAIL_HOST={{ docker_email_host }}
EMAIL_PORT={{ docker_email_port }}
EMAIL_USERNAME={{ docker_email_username }}
EMAIL_PASSWORD={{ docker_email_password }}
EMAIL={{ docker_email }}

## SWAG (reverse proxy)
SWAG_URL={{ docker_base_domain }}
SWAG_VALIDATION=dns
SWAG_SUBDOMAINS=wildcard
SWAG_ONLY_SUBDOMAINS=false
SWAG_DNSPLUGIN=cloudflare
SWAG_EXTRA_DOMAINS=*.smdion.com
SWAG_STAGING=false
SWAG_AUTORELOAD=true
SWAG_DOCKER_MODS=linuxserver/mods:swag-dashboard|linuxserver/mods:swag-maxmind|ghcr.io/linuxserver/mods:swag-crowdsec
SWAG_NGINX_LOG_PATH=/config/log/nginx/access.log
SWAG_GEO_MEASUREMENT=geoip2influx
SWAG_LOG_MEASUREMENT=nginx_access_logs
SWAG_GEOIP2INFLUX_LOG_LEVEL=error
SWAG_GEOIP2_SEND_NGINX_LOGS=true
SWAG_INFLUX_DATABASE=geoip2influx-{{ docker_base_domain }}
SWAG_DISABLE_F2B=true

## SWAG — secrets
SWAG_CROWDSEC_API_KEY={{ docker_crowdsec_api_key }}
MAXMINDDB_LICENSE_KEY={{ docker_maxmind_license_key }}
MAXMINDDB_USER_ID={{ docker_maxmind_user_id }}

## SWAG — InfluxDB connection
INFLUX_HOST=PRIVATE_IP_REDACTED
INFLUX_HOST_PORT=8086
INFLUX_RETENTION=30d
INFLUX_SHARD=7d

## CrowdSec — LAPI
CROWDSEC_COLLECTIONS=crowdsecurity/nginx crowdsecurity/http-cve crowdsecurity/whitelist-good-actors firix/authentik crowdsecurity/wordpress
CROWDSEC_CUSTOM_HOSTNAME=crowdsec
CROWDSEC_LAPI_URL=http://{{ vault_vm_tantiveiv_ip }}:8080
