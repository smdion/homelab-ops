# Docker Compose override — volume definitions for the dev stack.
# Templated by deploy_stacks.yaml to docker-compose.override.yaml on the host.
# Not committed (docker-compose.override.yaml is gitignored); this template is.
# core/apps: NFS mounts from core/apps VMs (bootstrap_vm.yaml nfs_mounts).
# dev: local /opt bind mount (same VM).
# vps: direct NFS — VPS has its own NFS export.
# Vault vars required:
#   vault_vps_nfs_ip  — IP address of the VPS NFS server
volumes:
  core:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: /mnt/nfs/core
  apps:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: /mnt/nfs/apps
  dev:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: /opt
  vps:
    driver_opts:
      type: nfs4
      o: "addr={{ vault_vps_nfs_ip }},soft,timeo=50,retrans=3"
      device: :/
