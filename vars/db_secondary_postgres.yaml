# db_password is in vars/secrets.yaml (vault)
db_host: "{{ db_host_secondary }}"
backup_stack: databases
backup_name: "Database"
backup_url: "https://sql.{{ domain_ext }}"
backup_description: "Automatic Database Backup"
backup_subtype: "Database"
backup_ext: "sql.gz"
backup_file: "backup_{{ item }}_{{ ansible_date_time.date }}.sql.gz"
db_username: "postgres"
db_container_name: "postgres-immich"
db_names: >-
  {{ app_definitions | dict2items
     | selectattr('value.db_config', 'defined')
     | selectattr('value.db_config', 'equalto', 'db_secondary_postgres')
     | map(attribute='value.db_names') | flatten | sort | list }}
is_postgres: true

# Restore support â€” maps each DB to dependent containers ON THE SAME HOST as postgres-immich.
db_container_deps:
  immich: ["immich-server", "immich-machine-learning"]
