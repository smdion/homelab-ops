src_raw_files:
  - "/opt"

# Database directories excluded from appdata archive.
# Only exclude directories that have dedicated backup jobs (SQL dumps or API exports).
backup_exclude_dirs:
  - /opt/mariadb
  - /opt/postgres
  - /opt/influxdb

backup_tmp_dir: "/backup"
backup_name: "Docker"
backup_description: "Automatic Docker Opt Backup"
backup_type: "Servers"
backup_subtype: "Appdata"
backup_file: "backup_docker_opt_{{ ansible_date_time.date }}.tar.gz"

# Update vars
update_name: "Docker"
update_description: "Automatic Docker Container Update"
update_type: "Servers"
update_subtype: "Container"
update_delay_days: 3
update_exclude_services:
  - semaphore

# Restore support — maps app names to containers, DB config, and DB host.
# Used by restore_hosts.yaml for selective and coordinated DB+appdata restore.
app_restore:
  authentik:
    containers: ["authentik", "authentik_worker"]
    db_config_file: db_primary_postgres
    db_host: "{{ db_host_primary }}"
    db_names: ["authentik"]
  jellyseerr:
    containers: ["jellyseerr"]
    db_config_file: db_primary_postgres
    db_host: "{{ db_host_primary }}"
    db_names: ["jellyseerr"]

# Stack assignments: host → ordered list of stack names.
# ORDER MATTERS: on tantive-iv, databases MUST precede auth (Authentik requires Postgres).
stack_assignments:
  vps.REDACTED_DOMAIN: [vpn]
  odyssey.REDACTED_DOMAIN: [infra, media, apps, nfs]
  tantiveiv.REDACTED_DOMAIN: [infra, databases, auth, monitoring, dev]

# Docker defaults — non-secret, shared across all stacks.
# Per-host MEM_LIMIT: tantive-iv=10g (12GB RAM), others=3000m (4GB RAM).
docker_mem_limit: >-
  {{ '10g' if inventory_hostname in groups.get('tantiveiv', []) else '3000m' }}
docker_tz: "America/Chicago"
docker_puid: "1000"
docker_pgid: "1000"
docker_umask: "022"
docker_appsdir: "/opt"
docker_restart: "always"
docker_postgres_user: "postgres"
docker_postgres_default_db: "postgres"
docker_adminer_design: "hydra"
docker_authentik_image: "ghcr.io/goauthentik/server"
docker_authentik_tag: "2025.12.4"
docker_email_host: "smtp.gmail.com"
docker_email_port: 587
docker_dozzle_level: "info"
docker_dozzle_remote_agent: "REDACTED_IP:7007,REDACTED_IP:7007,REDACTED_IP:7007,REDACTED_IP:7007"
docker_dozzle_hostname: "Odyssey"
