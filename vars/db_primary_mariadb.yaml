# db_password is in vars/secrets.yaml (vault)
db_host: "{{ db_host_primary }}"
backup_stack: databases
backup_name: "Database"
backup_url: "https://sql.{{ domain_ext }}"
backup_description: "Automatic Database Backup"
backup_subtype: "Database"
backup_ext: "sql.gz"
backup_file: "backup_{{ item }}_{{ ansible_date_time.date }}.sql.gz"
db_username: "root"
db_container_name: "mariadb"
db_names: >-
  {{ app_definitions | dict2items
     | selectattr('value.db_config', 'defined')
     | selectattr('value.db_config', 'equalto', 'db_primary_mariadb')
     | map(attribute='value.db_names') | flatten | sort | list }}
is_mariadb: true

# Restore support — maps each DB to dependent containers ON THE SAME HOST as mariadb.
# Cross-host deps (app on a different host) are [] — use restore_hosts.yaml -e with_databases=yes.
db_container_deps:
  nextcloud: []
  semaphore: []
  ansible_logging: []
